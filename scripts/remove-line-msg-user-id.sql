-- ============================================================================
-- line_msg_user_id カラム削除スクリプト
-- ============================================================================
--
-- このカラムは以下の3システムすべてで使用されていないことを確認済み:
-- - vi-admin
-- - shift-management-app
-- - table-management-system (POS)
--
-- 実行前の確認事項:
-- 1. データベースのバックアップを取得
-- 2. このカラムに実際にデータが入っているか確認（下記クエリ参照）
-- ============================================================================

-- ステップ1: カラムにデータが入っているか確認
SELECT
  COUNT(*) as total_rows,
  COUNT(line_msg_user_id) as rows_with_data,
  COUNT(*) - COUNT(line_msg_user_id) as rows_with_null
FROM casts;

-- ステップ2: データがある場合は確認
-- （このクエリは line_msg_user_id にデータがある行のみ表示）
SELECT id, name, line_msg_user_id
FROM casts
WHERE line_msg_user_id IS NOT NULL;

-- ============================================================================
-- ステップ3: カラム削除（データがないことを確認後に実行）
-- ============================================================================
-- 注意: この操作は取り消せません！必ずバックアップを取ってから実行してください。

ALTER TABLE casts DROP COLUMN line_msg_user_id;

-- ============================================================================
-- 確認: カラムが削除されたことを確認
-- ============================================================================
SELECT column_name, data_type, is_nullable
FROM information_schema.columns
WHERE table_name = 'casts'
ORDER BY ordinal_position;
